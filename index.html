<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PayrollPro - Curso Profesional Avanzado de Liquidaci√≥n de Sueldos</title>
  <meta name="description" content="Domina la liquidaci√≥n de sueldos con nuestro curso l√≠der en la industria. Certificaci√≥n reconocida, instructores expertos y contenido actualizado.">
  
  <!-- Fuentes y estilos -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://sdk.mercadopago.com/js/v2"></script>
  <!-- Estilos personalizados -->
  <style>
    :root {
      --primary-color: #4a90e2;
      --secondary-color: #50e3c2;
    }
    body {
      font-family: 'Inter', sans-serif;
    }
    /* Animaci√≥n flotante */
    @keyframes float {
      0% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
      100% { transform: translateY(0); }
    }
    .float {
      animation: float 6s ease-in-out infinite;
    }
    /* Texto degradado */
    .gradient-text {
      background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    /* Tarjetas de caracter√≠stica con hover */
    .feature-card:hover {
      transform: scale(1.05);
      transition: transform 0.3s ease;
    }
    /* Encabezado fijo (sticky) */
    .sticky-header {
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      backdrop-filter: blur(5px);
      transition: all 0.3s ease-in-out;
    }
    /* Barra de progreso de scroll */
    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 4px;
      background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
      z-index: 1001;
    }
    /* Divisor de forma personalizada */
    .custom-shape-divider-bottom {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      overflow: hidden;
      line-height: 0;
    }
    .custom-shape-divider-bottom svg {
      display: block;
      width: calc(100% + 1.3px);
      height: 150px;
    }
    .custom-shape-divider-bottom .shape-fill {
      fill: #FFFFFF;
    }
    /* Estilos para el contador */
    .countdown-timer {
      display: flex;
      justify-content: center;
      gap: 1rem;
    }
    .countdown-item {
      text-align: center;
    }
    .countdown-value {
      font-size: 2rem;
      font-weight: bold;
    }
    .countdown-label {
      font-size: 0.875rem;
      text-transform: uppercase;
    }
    /* Widget de chat */
    .chat-widget {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
    }
    .chat-button {
      background-color: var(--primary-color);
      color: white;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .chat-popup {
      display: none;
      position: absolute;
      bottom: 80px;
      right: 0;
      width: 300px;
      height: 400px;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    /* Barras de habilidades */
    .skill-bar {
      width: 100%;
      height: 20px;
      background-color: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
    }
    .skill-progress {
      height: 100%;
      background-color: var(--primary-color);
      transition: width 1s ease-in-out;
    }
    /* Notificaciones globales */
    .global-notification {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: rgba(74, 144, 226, 0.95);
      color: #fff;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      z-index: 1100;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease, transform 0.6s ease;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
    }
    .global-notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    .global-notification i {
      margin-right: 8px;
    }

            /* Add new styles for the multi-step form */
            .form-step {
            display: none;
        }
        .form-step.active {
            display: block;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .step.active {
            background-color: #4a90e2;
            color: white;
        }

        input[type="email"],
    input[type="text"],
    input[type="tel"] {
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }

    /* Bot√≥n de env√≠o */
    .btn {
      background: #007BFF;
      border: none;
      color: #fff;
      padding: 12px;
      margin-top: 10px;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn:disabled {
      background: #999;
      cursor: not-allowed;
    }

    .btn:hover:not(:disabled) {
      background: #0056b3;
    }

    /* Spinner para la animaci√≥n */
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #007BFF;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="bg-gradient-to-b from-blue-50 to-white">
  <!-- Barra de progreso -->
  <div class="progress-bar" id="myBar"></div>

  <!-- Cabecera -->
  <header id="main-header" class="bg-white bg-opacity-90 shadow-md">
    <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
      <div class="flex items-center">
        <img src="https://via.placeholder.com/50" alt="Logo PayrollPro" class="h-10 w-10 mr-3">
        <span class="text-2xl font-bold gradient-text">PayrollPro</span>
      </div>
      <div class="hidden md:flex space-x-4">
        <a href="#features" class="text-gray-700 hover:text-blue-600 transition duration-300">Caracter√≠sticas</a>
        <a href="#course-overview" class="text-gray-700 hover:text-blue-600 transition duration-300">Contenido</a>
        <a href="#testimonials" class="text-gray-700 hover:text-blue-600 transition duration-300">Testimonios</a>
        <a href="#pricing" class="text-gray-700 hover:text-blue-600 transition duration-300">Precios</a>
        <a href="#faq" class="text-gray-700 hover:text-blue-600 transition duration-300">FAQ</a>
      </div>
      <button class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-300 hidden md:block" id="cta-button">Inscribirse Ahora</button>
      <!-- Bot√≥n de men√∫ m√≥vil -->
      <button class="md:hidden" id="menu-toggle" aria-label="Men√∫">
        <i data-feather="menu"></i>
      </button>
    </nav>
    <!-- Men√∫ m√≥vil -->
    <div class="md:hidden mt-4 space-y-2 hidden" id="mobile-menu">
      <a href="#features" class="block text-gray-700 hover:text-blue-600 transition duration-300">Caracter√≠sticas</a>
      <a href="#course-overview" class="block text-gray-700 hover:text-blue-600 transition duration-300">Contenido</a>
      <a href="#testimonials" class="block text-gray-700 hover:text-blue-600 transition duration-300">Testimonios</a>
      <a href="#pricing" class="block text-gray-700 hover:text-blue-600 transition duration-300">Precios</a>
      <a href="#faq" class="block text-gray-700 hover:text-blue-600 transition duration-300">FAQ</a>
      <button class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-300 mt-2">Inscribirse Ahora</button>
    </div>
  </header>

  <!-- Contenido Principal -->
  <main>
    <!-- Secci√≥n Hero -->
    <section class="relative overflow-hidden">
      <div class="container mx-auto px-6 py-16 md:py-24 flex flex-col md:flex-row items-center">
        <div class="md:w-1/2 mb-8 md:mb-0" data-aos="fade-right">
          <h1 class="text-4xl md:text-6xl font-bold text-gray-800 mb-4 leading-tight">
            Domina la <span class="gradient-text">Liquidaci√≥n de Sueldos</span> y Potencia tu Carrera
          </h1>
          <p class="text-xl text-gray-600 mb-8">
            Convi√©rtete en un experto certificado en n√≥minas con nuestro curso l√≠der en la industria.
            <span id="typed-text"></span>
          </p>
          <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
            <button class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-lg font-semibold transition transform hover:scale-105" id="main-cta">
              ¬°Inscr√≠bete Ahora! <i data-feather="arrow-right" class="inline-block ml-2"></i>
            </button>
            <button class="bg-white text-blue-600 border border-blue-600 px-6 py-3 rounded-lg text-lg font-semibold transition transform hover:bg-blue-50 hover:scale-105" id="demo-button">
              <i data-feather="play" class="inline-block mr-2"></i> Ver Demo del Curso
            </button>
          </div>
          <div class="mt-8 flex items-center space-x-4">
            <img src="https://via.placeholder.com/100x50" alt="Certificaci√≥n ISO" class="h-12">
            <img src="https://via.placeholder.com/100x50" alt="Asociaci√≥n de RRHH" class="h-12">
            <img src="https://via.placeholder.com/100x50" alt="Premio Educaci√≥n" class="h-12">
          </div>
        </div>
        <div class="md:w-1/2 float" data-aos="fade-left">
          <img src="https://via.placeholder.com/600x400" alt="Curso de Liquidaci√≥n de Sueldos" class="rounded-lg shadow-2xl">
        </div>
      </div>
      <!-- Divisor decorativo -->
      <div class="custom-shape-divider-bottom">
        <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
          <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path>
        </svg>
      </div>
    </section>

    <!-- Secci√≥n Estad√≠sticas -->
    <section class="bg-blue-600 text-white py-12 relative">
      <div class="container mx-auto px-6 text-center">
        <h2 class="text-3xl font-bold mb-4">M√°s de 10,000 profesionales capacitados</h2>
        <p class="text-xl mb-8">√önete a la comunidad l√≠der en gesti√≥n de n√≥minas y RRHH</p>
        <div class="flex justify-center space-x-8">
          <div>
            <span class="text-4xl font-bold" id="satisfaction-counter">0</span>%
            <p>Satisfacci√≥n</p>
          </div>
          <div>
            <span class="text-4xl font-bold" id="completion-counter">0</span>%
            <p>Finalizaci√≥n</p>
          </div>
          <div>
            <span class="text-4xl font-bold" id="salary-counter">0</span>%
            <p>Mejora Salarial</p>
          </div>
        </div>
      </div>
      <div class="absolute bottom-0 left-0 w-full overflow-hidden">
        <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
          <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V120H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="fill-current text-gray-100"></path>
        </svg>
      </div>
    </section>

    <!-- Secci√≥n Caracter√≠sticas -->
    <section id="features" class="bg-gray-100 py-16 md:py-24">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">Caracter√≠sticas del Curso</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <div class="feature-card bg-white p-6 rounded-lg shadow-lg" data-aos="fade-up">
            <i data-feather="book-open" class="w-12 h-12 text-blue-600 mb-4"></i>
            <h3 class="text-xl font-semibold mb-2">Contenido Actualizado</h3>
            <p class="text-gray-600">Material siempre al d√≠a con normativas y tendencias.</p>
          </div>
          <div class="feature-card bg-white p-6 rounded-lg shadow-lg" data-aos="fade-up" data-aos-delay="100">
            <i data-feather="users" class="w-12 h-12 text-blue-600 mb-4"></i>
            <h3 class="text-xl font-semibold mb-2">Clases en Vivo</h3>
            <p class="text-gray-600">Sesiones interactivas con expertos del sector.</p>
          </div>
          <div class="feature-card bg-white p-6 rounded-lg shadow-lg" data-aos="fade-up" data-aos-delay="200">
            <i data-feather="award" class="w-12 h-12 text-blue-600 mb-4"></i>
            <h3 class="text-xl font-semibold mb-2">Certificaci√≥n Avalada</h3>
            <p class="text-gray-600">Certificado reconocido por importantes empresas.</p>
          </div>
          <div class="feature-card bg-white p-6 rounded-lg shadow-lg" data-aos="fade-up" data-aos-delay="300">
            <i data-feather="trending-up" class="w-12 h-12 text-blue-600 mb-4"></i>
            <h3 class="text-xl font-semibold mb-2">Casos Pr√°cticos Reales</h3>
            <p class="text-gray-600">Aplicaci√≥n pr√°ctica en escenarios reales.</p>
          </div>
          <div class="feature-card bg-white p-6 rounded-lg shadow-lg" data-aos="fade-up" data-aos-delay="400">
            <i data-feather="clock" class="w-12 h-12 text-blue-600 mb-4"></i>
            <h3 class="text-xl font-semibold mb-2">Acceso 24/7</h3>
            <p class="text-gray-600">Estudia a tu ritmo con acceso ilimitado.</p>
          </div>
          <div class="feature-card bg-white p-6 rounded-lg shadow-lg" data-aos="fade-up" data-aos-delay="500">
            <i data-feather="headphones" class="w-12 h-12 text-blue-600 mb-4"></i>
            <h3 class="text-xl font-semibold mb-2">Soporte Personalizado</h3>
            <p class="text-gray-600">Asistencia de tutores expertos cuando la necesites.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Contenido del Curso -->
    <section id="course-overview" class="py-16 md:py-24 bg-white">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">Contenido del Curso</h2>
        <div class="grid md:grid-cols-2 gap-8 items-center">
          <div data-aos="fade-right">
            <h3 class="text-2xl font-semibold mb-6">Lo que aprender√°s:</h3>
            <ul class="space-y-4" id="course-content">
              <!-- Se insertar√° el contenido din√°micamente -->
            </ul>
          </div>
          <div class="relative" data-aos="fade-left">
            <img src="https://via.placeholder.com/600x400" alt="Curso de Liquidaci√≥n de Sueldos" class="rounded-lg shadow-xl">
            <div class="absolute inset-0 bg-blue-600 opacity-20 rounded-lg"></div>
            <div class="absolute inset-0 flex items-center justify-center">
              <p class="text-white text-3xl font-bold">8 M√≥dulos Completos</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Plan de Estudios -->
    <section id="curriculum-preview" class="bg-gray-100 py-16">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">Vista Previa del Plan de Estudios</h2>
        <div class="bg-white p-6 rounded-lg shadow-lg" style="max-height: 400px; overflow-y: auto;">
          <div class="mb-6">
            <h3 class="text-xl font-semibold mb-2">M√≥dulo 1: Fundamentos de la Liquidaci√≥n de Sueldos</h3>
            <ul class="list-disc list-inside text-gray-600">
              <li>Introducci√≥n a la legislaci√≥n laboral</li>
              <li>Conceptos b√°sicos de remuneraci√≥n</li>
              <li>Tipos de contratos laborales</li>
            </ul>
          </div>
          <div class="mb-6">
            <h3 class="text-xl font-semibold mb-2">M√≥dulo 2: C√°lculo de Remuneraciones</h3>
            <ul class="list-disc list-inside text-gray-600">
              <li>Salario base y complementos</li>
              <li>Horas extras y bonificaciones</li>
              <li>Deducciones legales y voluntarias</li>
            </ul>
          </div>
          <div class="mb-6">
            <h3 class="text-xl font-semibold mb-2">M√≥dulo 3: Gesti√≥n de Beneficios Sociales</h3>
            <ul class="list-disc list-inside text-gray-600">
              <li>Vacaciones y licencias</li>
              <li>Seguridad social y seguros</li>
              <li>Planes de pensiones y jubilaci√≥n</li>
            </ul>
          </div>
          <!-- Se pueden agregar m√°s m√≥dulos -->
        </div>
      </div>
    </section>

    <!-- Secci√≥n Instructores -->
    <section id="instructors" class="bg-white py-16">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">Nuestros Instructores Expertos</h2>
        <div class="swiper-container">
          <div class="swiper-wrapper">
            <div class="swiper-slide bg-white p-6 rounded-lg shadow-lg">
              <img src="https://via.placeholder.com/150" alt="Instructor 1" class="w-32 h-32 rounded-full mx-auto mb-4">
              <h3 class="text-xl font-semibold text-center mb-2">Dra. Mar√≠a Rodr√≠guez</h3>
              <p class="text-gray-600 text-center mb-4">Ex Directora de RRHH en Fortune 500</p>
              <p class="text-gray-700 text-center">20+ a√±os de experiencia en n√≥minas.</p>
            </div>
            <div class="swiper-slide bg-white p-6 rounded-lg shadow-lg">
              <img src="https://via.placeholder.com/150" alt="Instructor 2" class="w-32 h-32 rounded-full mx-auto mb-4">
              <h3 class="text-xl font-semibold text-center mb-2">Lic. Carlos G√≥mez</h3>
              <p class="text-gray-600 text-center mb-4">Consultor Senior en Deloitte</p>
              <p class="text-gray-700 text-center">Especialista en legislaci√≥n laboral y optimizaci√≥n de n√≥minas.</p>
            </div>
            <div class="swiper-slide bg-white p-6 rounded-lg shadow-lg">
              <img src="https://via.placeholder.com/150" alt="Instructor 3" class="w-32 h-32 rounded-full mx-auto mb-4">
              <h3 class="text-xl font-semibold text-center mb-2">Ing. Ana Mart√≠nez</h3>
              <p class="text-gray-600 text-center mb-4">Desarrolladora de Software de RRHH</p>
              <p class="text-gray-700 text-center">Experta en sistemas de gesti√≥n de n√≥minas.</p>
            </div>
          </div>
          <div class="swiper-pagination"></div>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Testimonios -->
    <section id="testimonials" class="bg-blue-600 py-16 md:py-24">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-white mb-12">Lo que dicen nuestros estudiantes</h2>
        <div class="relative max-w-4xl mx-auto">
          <div id="testimonial-container" class="bg-white p-8 rounded-lg shadow-lg">
            <!-- Testimonio se renderizar√° din√°micamente -->
          </div>
          <button id="prev-testimonial" class="absolute top-1/2 -left-4 transform -translate-y-1/2 bg-white rounded-full p-2 shadow-md" aria-label="Testimonio anterior">
            <i data-feather="chevron-left" class="w-6 h-6 text-blue-600"></i>
          </button>
          <button id="next-testimonial" class="absolute top-1/2 -right-4 transform -translate-y-1/2 bg-white rounded-full p-2 shadow-md" aria-label="Siguiente testimonio">
            <i data-feather="chevron-right" class="w-6 h-6 text-blue-600"></i>
          </button>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Precios y Pago -->
    <section id="pricing" class="py-16 md:py-24">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">Accede al Curso Completo</h2>
        <div class="max-w-xl mx-auto text-center">
          <p class="text-lg text-gray-600 mb-6">
            ¬°Oferta imperdible! Aprovecha un <span class="text-red-600 font-bold">90% de descuento</span>:
            <span class="line-through text-gray-500">$4990</span>
            <span class="text-green-600 text-4xl font-extrabold animate-pulse inline-block ml-2">$499</span>
          </p>
          <p class="mb-8 text-sm text-gray-500">
            Compra 100% segura ‚Äì Pago cifrado SSL, garant√≠a de satisfacci√≥n y soporte 24/7.
          </p>
          <!-- Lista de beneficios -->
          <ul class="mb-8 text-left space-y-2">
            <li class="flex items-center">
              <i data-feather="check-circle" class="w-5 h-5 text-green-600 mr-2"></i>
              Acceso ilimitado a todos los m√≥dulos.
            </li>
            <li class="flex items-center">
              <i data-feather="check-circle" class="w-5 h-5 text-green-600 mr-2"></i>
              Evaluaci√≥n final para certificar tus conocimientos.
            </li>
            <li class="flex items-center">
              <i data-feather="check-circle" class="w-5 h-5 text-green-600 mr-2"></i>
              Certificado profesional avalado.
            </li>
            <li class="flex items-center">
              <i data-feather="check-circle" class="w-5 h-5 text-green-600 mr-2"></i>
              Temario actualizado y ampliado.
            </li>
            <li class="flex items-center">
              <i data-feather="check-circle" class="w-5 h-5 text-green-600 mr-2"></i>
              Notificaciones en tiempo real.
            </li>
          </ul>
          <!-- Formulario de pago
          Multi-step Form -->

                  <div class="max-w-xl mx-auto text-center">
                      <!-- ... (keep the existing content before the form) ... -->
                      
                      <!-- Multi-step Form -->
                      <form id="multi-step-form" class="bg-white p-8 rounded-lg shadow-lg">
                          <div class="step-indicator">
                              <div class="step active">1</div>
                              <div class="step">2</div>
                          </div>
                          
                          <!-- Step 1: Personal Information -->
                          <div class="form-step active" id="subscriptionForm">
                              <div class="mb-4">
                                  <label for="nombre" class="block text-left font-semibold mb-2">Nombre Completo</label>
                                  <input type="text" id="nombre" name="nombre" required class="w-full p-3 border rounded focus:outline-none focus:border-blue-600">
                              </div>
                              <div class="mb-4">
                                  <label for="apellido" class="block text-left font-semibold mb-2">Apellido</label>
                                  <input type="text" id="apellido" name="apellido" required class="w-full p-3 border rounded focus:outline-none focus:border-blue-600">
                              </div>
                              <div class="mb-4">
                                  <label for="celular" class="block text-left font-semibold mb-2">Celular</label>
                                  <input type="tel" id="celular" name="celular" required class="w-full p-3 border rounded focus:outline-none focus:border-blue-600" placeholder="+1 234 567 890">
                              </div>
                              <div class="mb-4">
                                  <label for="email" class="block text-left font-semibold mb-2">Correo Electr√≥nico</label>
                                  <input type="email" id="email" name="email" required class="w-full p-3 border rounded focus:outline-none focus:border-blue-600">
                              </div>
                              <button type="submit" id="submitBtn" class="w-full bg-blue-600 text-white px-4 py-3 rounded hover:bg-blue-700 transition duration-300">
                                <span class="btn-text">Continuar al Pago</span>
                              </button>
                          </div>
                          
                          <!-- Step 2: Payment -->
                          <div class="form-step" id="step2">
                              <h3 class="text-xl font-semibold mb-4">Resumen de la Compra</h3>
                              <p class="mb-4">Curso Profesional Avanzado de Liquidaci√≥n de Sueldos</p>
                              <p class="text-2xl font-bold mb-6">Total: $4990</p>
                              <div id="wallet_container"></div>
                              <button type="button" class="w-full mt-4 bg-gray-300 text-gray-700 px-4 py-3 rounded hover:bg-gray-400 transition duration-300" onclick="prevStep()">
                                  Volver
                              </button>
                          </div>
                      </form>

                    </div>

        
          <!-- Sellos de confianza -->
          <div class="mt-6 flex justify-around">
            <div class="flex items-center space-x-2">
              <i data-feather="shield" class="text-blue-600"></i>
              <span class="text-sm text-gray-600">Compra Segura</span>
            </div>
            <div class="flex items-center space-x-2">
              <i data-feather="check-circle" class="text-green-600"></i>
              <span class="text-sm text-gray-600">Garant√≠a 30 d√≠as</span>
            </div>
            <div class="flex items-center space-x-2">
              <i data-feather="headphones" class="text-blue-600"></i>
              <span class="text-sm text-gray-600">Soporte 24/7</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Garant√≠a -->
    <section id="guarantee" class="bg-gray-100 py-16">
      <div class="container mx-auto px-6 text-center">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-8">Nuestra Garant√≠a de Satisfacci√≥n</h2>
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-2xl mx-auto">
          <i data-feather="shield" class="w-16 h-16 text-blue-600 mx-auto mb-4"></i>
          <p class="text-xl mb-4">Si no est√°s satisfecho en los primeros 30 d√≠as, te devolvemos el 100% de tu inversi√≥n.</p>
          <p class="text-gray-600">Sin preguntas. Sin complicaciones.</p>
        </div>
      </div>
    </section>

    <!-- Secci√≥n FAQ -->
    <section id="faq" class="py-16 md:py-24 bg-white">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">Preguntas Frecuentes</h2>
        <div class="max-w-3xl mx-auto">
          <div class="border-b border-gray-200 py-4">
            <button class="flex justify-between items-center w-full text-left" onclick="toggleFAQ(this)">
              <span class="text-lg font-semibold">¬øCu√°nto dura el curso?</span>
              <i data-feather="chevron-down" class="w-5 h-5"></i>
            </button>
            <div class="mt-2 hidden">
              <p class="text-gray-600">El curso dura 12 semanas con 5-7 horas semanales, y tienes acceso extendido seg√∫n el plan.</p>
            </div>
          </div>
          <div class="border-b border-gray-200 py-4">
            <button class="flex justify-between items-center w-full text-left" onclick="toggleFAQ(this)">
              <span class="text-lg font-semibold">¬øNecesito conocimientos previos?</span>
              <i data-feather="chevron-down" class="w-5 h-5"></i>
            </button>
            <div class="mt-2 hidden">
              <p class="text-gray-600">No se requieren conocimientos previos; el curso se adapta a principiantes y profesionales.</p>
            </div>
          </div>
          <div class="border-b border-gray-200 py-4">
            <button class="flex justify-between items-center w-full text-left" onclick="toggleFAQ(this)">
              <span class="text-lg font-semibold">¬øEl certificado tiene validez oficial?</span>
              <i data-feather="chevron-down" class="w-5 h-5"></i>
            </button>
            <div class="mt-2 hidden">
              <p class="text-gray-600">Nuestro certificado es reconocido en la industria y avalado por asociaciones profesionales.</p>
            </div>
          </div>
          <div class="border-b border-gray-200 py-4">
            <button class="flex justify-between items-center w-full text-left" onclick="toggleFAQ(this)">
              <span class="text-lg font-semibold">¬øC√≥mo son las clases en vivo?</span>
              <i data-feather="chevron-down" class="w-5 h-5"></i>
            </button>
            <div class="mt-2 hidden">
              <p class="text-gray-600">Las clases en vivo son sesiones interactivas semanales que se graban para tu comodidad.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Secci√≥n CTA Final -->
    <section class="py-16 md:py-24 bg-blue-600 text-white">
      <div class="container mx-auto px-6 text-center" data-aos="fade-up">
        <h2 class="text-3xl md:text-4xl font-bold mb-6">¬øListo para impulsar tu carrera?</h2>
        <p class="text-xl mb-8 max-w-2xl mx-auto">
          No esperes m√°s para convertirte en un experto certificado en liquidaci√≥n de sueldos. ¬°Inscr√≠bete ahora y da el primer paso hacia el √©xito profesional!
        </p>
        <button class="bg-white text-blue-600 px-8 py-3 rounded-lg text-lg font-semibold hover:bg-blue-100 transition transform hover:scale-105" id="final-cta">
          ¬°Inscr√≠bete Ahora! <i data-feather="arrow-right" class="inline-block ml-2"></i>
        </button>
      </div>
    </section>

    <!-- Secci√≥n Cuenta Regresiva -->
    <section id="countdown" class="bg-gray-100 py-16">
      <div class="container mx-auto px-6 text-center">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-8">Pr√≥ximo inicio de curso</h2>
        <div class="countdown-timer">
          <div class="countdown-item">
            <span class="countdown-value" id="days">00</span>
            <span class="countdown-label">D√≠as</span>
          </div>
          <div class="countdown-item">
            <span class="countdown-value" id="hours">00</span>
            <span class="countdown-label">Horas</span>
          </div>
          <div class="countdown-item">
            <span class="countdown-value" id="minutes">00</span>
            <span class="countdown-label">Minutos</span>
          </div>
          <div class="countdown-item">
            <span class="countdown-value" id="seconds">00</span>
            <span class="countdown-label">Segundos</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Evaluaci√≥n de Habilidades -->
    <section id="skills-assessment" class="bg-white py-16">
      <div class="container mx-auto px-6">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">Eval√∫a tus Habilidades</h2>
        <div class="max-w-3xl mx-auto">
          <p class="text-center mb-8">Responde nuestro cuestionario r√°pido para evaluar tus conocimientos en liquidaci√≥n de sueldos.</p>
          <div class="bg-gray-100 p-6 rounded-lg">
            <h3 class="text-xl font-semibold mb-4">Legislaci√≥n Laboral</h3>
            <div class="skill-bar mb-4">
              <div class="skill-progress" style="width: 0%" data-target="75%"></div>
            </div>
            <h3 class="text-xl font-semibold mb-4">C√°lculo de N√≥minas</h3>
            <div class="skill-bar mb-4">
              <div class="skill-progress" style="width: 0%" data-target="60%"></div>
            </div>
            <h3 class="text-xl font-semibold mb-4">Software de Gesti√≥n de N√≥minas</h3>
            <div class="skill-bar mb-4">
              <div class="skill-progress" style="width: 0%" data-target="40%"></div>
            </div>
          </div>
          <div class="text-center mt-8">
            <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition" id="start-assessment">
              Iniciar Evaluaci√≥n Completa
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Pie de P√°gina -->
  <footer class="bg-gray-800 text-white py-12">
    <div class="container mx-auto px-6">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-lg font-semibold mb-4">PayrollPro</h3>
          <p class="text-gray-400">Formando expertos en liquidaci√≥n de sueldos desde 2010.</p>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Enlaces R√°pidos</h4>
          <ul class="space-y-2">
            <li><a href="#features" class="text-gray-400 hover:text-white transition">Caracter√≠sticas</a></li>
            <li><a href="#course-overview" class="text-gray-400 hover:text-white transition">Contenido</a></li>
            <li><a href="#testimonials" class="text-gray-400 hover:text-white transition">Testimonios</a></li>
            <li><a href="#pricing" class="text-gray-400 hover:text-white transition">Precios</a></li>
            <li><a href="#faq" class="text-gray-400 hover:text-white transition">FAQ</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Contacto</h4>
          <p class="text-gray-400">Email: info@payrollpro.com</p>
          <p class="text-gray-400">Tel√©fono: +1 234 567 890</p>
          <div class="mt-4">
            <a href="#" class="text-gray-400 hover:text-white transition mr-4"><i data-feather="facebook"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition mr-4"><i data-feather="twitter"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition mr-4"><i data-feather="instagram"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition"><i data-feather="linkedin"></i></a>
          </div>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Suscr√≠bete al Newsletter</h4>
          <form id="newsletter-form" class="flex space-x-2">
            <input type="email" placeholder="Tu email" class="bg-gray-700 text-white px-4 py-2 rounded flex-grow" required>
            <button type="submit" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded transition">
              <i data-feather="send" class="w-5 h-5"></i>
            </button>
          </form>
        </div>
      </div>
      <div class="mt-8 pt-8 border-t border-gray-700">
        <p class="text-center text-gray-400">&copy; 2025 PayrollPro. Todos los derechos reservados.</p>
      </div>
    </div>
  </footer>

  <!-- Widget de Chat -->
  <div class="chat-widget">
    <div class="chat-button" id="chat-button" aria-label="Abrir chat">
      <i data-feather="message-circle"></i>
    </div>
    <div class="chat-popup" id="chat-popup" role="dialog" aria-modal="true">
      <p class="p-4 text-gray-700">Hola, ¬øen qu√© podemos ayudarte?</p>
    </div>
  </div>

  <!-- Notificaciones Globales -->
  <div id="global-notification" class="global-notification"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  
  <!-- Script principal -->
  <script>
    // Inicializaci√≥n de librer√≠as
    AOS.init({ duration: 1000, once: true });
    feather.replace();

    // Men√∫ m√≥vil
    document.getElementById('menu-toggle').addEventListener('click', () => {
      document.getElementById('mobile-menu').classList.toggle('hidden');
    });

    // Sticky header y barra de progreso al hacer scroll
    window.addEventListener('scroll', () => {
      const header = document.getElementById('main-header');
      if (window.scrollY > 100) header.classList.add('sticky-header');
      else header.classList.remove('sticky-header');

      const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      document.getElementById("myBar").style.width = scrolled + "%";
    });

    // Typed.js para animar el texto del h√©roe
    new Typed('#typed-text', {
      strings: [
        'Avalado por las principales empresas.',
        'Certificaci√≥n reconocida en la industria.',
        'Instructores expertos en n√≥minas.'
      ],
      typeSpeed: 50,
      backSpeed: 25,
      backDelay: 1500,
      loop: true
    });

    // Contenido din√°mico del curso
    const courseContent = [
      'Fundamentos avanzados de la liquidaci√≥n de sueldos',
      'Marco legal y normativo actualizado',
      'C√°lculo preciso de remuneraciones y deducciones',
      'Gesti√≥n estrat√©gica de beneficios y compensaciones',
      'Optimizaci√≥n de impuestos y contribuciones sociales',
      'Dominio de software l√≠der en n√≥minas',
      'An√°lisis avanzado de costos laborales',
      'Resoluci√≥n de casos complejos y situaciones especiales'
    ];
    const courseContentContainer = document.getElementById('course-content');
    courseContent.forEach((item, index) => {
      const li = document.createElement('li');
      li.className = 'flex items-start opacity-0 transform translate-y-4 transition duration-300';
      li.innerHTML = `<i data-feather="check-circle" class="w-6 h-6 text-green-500 mr-2"></i><span>${item}</span>`;
      courseContentContainer.appendChild(li);
      // Animaci√≥n secuencial
      setTimeout(() => {
        li.classList.remove('opacity-0', 'translate-y-4');
        feather.replace();
      }, index * 100);
    });

    // Testimonios
    const testimonials = [
      { name: 'Mar√≠a Gonz√°lez', role: 'Gerente de RRHH', content: 'Este curso transform√≥ nuestra gesti√≥n de n√≥minas. El contenido es actualizado y los instructores son verdaderos expertos.', image: 'https://via.placeholder.com/100' },
      { name: 'Carlos Rodr√≠guez', role: 'Contador Senior', content: 'Como contador, este curso me dio herramientas para expandir mis servicios y ofrecer mayor valor a mis clientes.', image: 'https://via.placeholder.com/100' },
      { name: 'Ana Mart√≠nez', role: 'Emprendedora', content: 'Gracias a este curso, puedo manejar la n√≥mina de mi startup con confianza. Los casos pr√°cticos y el soporte fueron invaluables.', image: 'https://via.placeholder.com/100' }
    ];
    let currentTestimonialIndex = 0;
    function renderTestimonial(index) {
      const t = testimonials[index];
      const testimonialHTML = `
        <div class="flex items-center mb-6">
          <img src="${t.image}" alt="${t.name}" class="w-20 h-20 rounded-full mr-4">
          <div>
            <h3 class="font-semibold text-xl">${t.name}</h3>
            <p class="text-gray-600">${t.role}</p>
          </div>
        </div>
        <p class="text-gray-700 mb-4 text-lg italic">"${t.content}"</p>
        <div class="flex text-yellow-400">
          ${Array(5).fill('<i data-feather="star" class="w-5 h-5"></i>').join('')}
        </div>
      `;
      document.getElementById('testimonial-container').innerHTML = testimonialHTML;
      feather.replace();
    }
    document.getElementById('prev-testimonial').addEventListener('click', () => {
      currentTestimonialIndex = (currentTestimonialIndex - 1 + testimonials.length) % testimonials.length;
      renderTestimonial(currentTestimonialIndex);
    });
    document.getElementById('next-testimonial').addEventListener('click', () => {
      currentTestimonialIndex = (currentTestimonialIndex + 1) % testimonials.length;
      renderTestimonial(currentTestimonialIndex);
    });
    // Render inicial de testimonio
    renderTestimonial(currentTestimonialIndex);

    // Funci√≥n para toggle FAQ
    function toggleFAQ(button) {
      const content = button.nextElementSibling;
      const icon = button.querySelector('i');
      content.classList.toggle('hidden');
      icon.setAttribute('data-feather', content.classList.contains('hidden') ? 'chevron-down' : 'chevron-up');
      feather.replace();
    }
    window.toggleFAQ = toggleFAQ;

    // Newsletter
    document.getElementById('newsletter-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = this.querySelector('input[type="email"]').value;
      alert(`Gracias por suscribirte con el email: ${email}`);
      this.reset();
    });

    // Animaci√≥n de contadores
    function animateValue(obj, start, end, duration) {
      let startTimestamp = null;
      const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const progress = Math.min((timestamp - startTimestamp) / duration, 1);
        obj.innerHTML = Math.floor(progress * (end - start) + start);
        if (progress < 1) window.requestAnimationFrame(step);
      };
      window.requestAnimationFrame(step);
    }
    const statsObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          animateValue(document.getElementById("satisfaction-counter"), 0, 98, 2000);
          animateValue(document.getElementById("completion-counter"), 0, 92, 2000);
          animateValue(document.getElementById("salary-counter"), 0, 85, 2000);
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.5 });
    statsObserver.observe(document.querySelector('.bg-blue-600'));

    // Smooth scrolling en enlaces ancla
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });

    // CTA y bot√≥n Demo
    document.querySelectorAll('#cta-button, #main-cta, #final-cta').forEach(button => {
      button.addEventListener('click', () => {
        alert('¬°Gracias por tu inter√©s! Pronto nos pondremos en contacto contigo.');
      });
    });
    document.getElementById('demo-button').addEventListener('click', () => {
      alert('Estamos preparando una demostraci√≥n del curso. Te enviaremos un correo con el enlace pronto.');
    });

    // Inicializaci√≥n de Swiper para instructores
    var swiper = new Swiper('.swiper-container', {
      effect: 'coverflow',
      grabCursor: true,
      centeredSlides: true,
      slidesPerView: 'auto',
      coverflowEffect: {
        rotate: 50,
        stretch: 0,
        depth: 100,
        modifier: 1,
        slideShadows: true,
      },
      pagination: {
        el: '.swiper-pagination',
      },
    });

    // Cuenta regresiva
    const countdownDate = new Date("2025-12-31T23:59:59").getTime();
    function updateCountdown() {
      const now = new Date().getTime();
      const distance = countdownDate - now;
      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);
      document.getElementById("days").innerText = days.toString().padStart(2, '0');
      document.getElementById("hours").innerText = hours.toString().padStart(2, '0');
      document.getElementById("minutes").innerText = minutes.toString().padStart(2, '0');
      document.getElementById("seconds").innerText = seconds.toString().padStart(2, '0');
      if (distance < 0) {
        clearInterval(countdownTimer);
        document.getElementById("countdown").innerHTML = "<p class='text-3xl font-bold'>¬°El curso ha comenzado!</p>";
      }
    }
    const countdownTimer = setInterval(updateCountdown, 1000);

    // Widget de Chat
    const chatButton = document.getElementById('chat-button');
    const chatPopup = document.getElementById('chat-popup');
    let isChatOpen = false;
    chatButton.addEventListener('click', () => {
      isChatOpen = !isChatOpen;
      chatPopup.style.display = isChatOpen ? 'block' : 'none';
    });

    // Animaci√≥n de barras de habilidad
    const skillBars = document.querySelectorAll('.skill-progress');
    const skillsObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.width = entry.target.getAttribute('data-target');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.5 });
    skillBars.forEach(bar => skillsObserver.observe(bar));

    // Evaluaci√≥n de habilidades
    document.getElementById('start-assessment').addEventListener('click', () => {
      alert('Iniciando evaluaci√≥n completa de habilidades...');
      // Redireccionar o mostrar modal con evaluaci√≥n completa
    });

    /* Simulaci√≥n de pago (al enviar el formulario)
    document.getElementById("payment-form").addEventListener("submit", function(event) {
      event.preventDefault();
      alert("Pago realizado con √©xito. Redirigiendo a la plataforma de estudio...");
      window.location.href = "n.html";
    });*/

    // Notificaciones Globales
    const notifications = [
      '<i data-feather="user-check"></i> üòÄ Juan P√©rez se ha unido. ¬°Bienvenido alumno!',
      '<i data-feather="user-check"></i> üòÉ Mar√≠a Garc√≠a acaba de inscribirse. ¬°Bienvenida!',
      '<i data-feather="user-check"></i> üôÇ Pedro L√≥pez ya disfruta del curso.',
      '<i data-feather="user-check"></i> üòä Sof√≠a Gonz√°lez se ha inscrito. ¬°Nuevos alumnos en l√≠nea!',
      '<i data-feather="award"></i> üéâ Laura Mart√≠nez ha recibido su <strong>certificado profesional</strong>. ¬°Felicidades!',
      '<i data-feather="award"></i> üéä Andr√©s Ram√≠rez ha obtenido su <strong>certificado profesional</strong>. ¬°Enhorabuena!'
    ];
    const globalNotification = document.getElementById("global-notification");
    let currentNotificationIndex = 0;
    function showNotification() {
      globalNotification.innerHTML = notifications[currentNotificationIndex];
      feather.replace({ 'stroke-width': 2 });
      globalNotification.classList.add("show");
      setTimeout(() => { globalNotification.classList.remove("show"); }, 2500);
      currentNotificationIndex = (currentNotificationIndex + 1) % notifications.length;
    }
    showNotification();
    setInterval(showNotification, 3000);
// Funci√≥n para generar una contrase√±a "f√°cil" aleatoria
function generarPassword(longitud = 8) {
  const caracteres = "abcdefghjkmnpqrstuvwxyzABCDEFGHJKMNPQRSTUVWXYZ23456789";
  let password = "";
  for (let i = 0; i < longitud; i++) {
    const indice = Math.floor(Math.random() * caracteres.length);
    password += caracteres.charAt(indice);
  }
  return password;
}


window.supabase = supabase.createClient(
  'https://hygdbhdujdvtuuagwfit.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5Z2RiaGR1amR2dHV1YWd3Zml0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg3Nzg3MzUsImV4cCI6MjA1NDM1NDczNX0.jDIZD6cXQHjkojSg_vJ0Q_cvTXVEG_B_NaiRnJZTDas'
);

document.addEventListener("DOMContentLoaded", function() {
  let currentStep = 1;
  const form = document.getElementById("multi-step-form");
  const submitBtn = document.getElementById("submitBtn");
  const btnText = submitBtn.querySelector(".btn-text");
  let compraId; // Variable para almacenar el ID de la compra

  function nextStep() {
    if (currentStep < 2) {
      document.querySelector(".form-step.active").classList.remove("active");
      currentStep++;
      document.getElementById(`step${currentStep}`).classList.add("active");
      updateStepIndicator();
    }
  }

  function prevStep() {
    if (currentStep > 1) {
      document.querySelector(".form-step.active").classList.remove("active");
      currentStep--;
      document.getElementById(`step${currentStep}`).classList.add("active");
      updateStepIndicator();
    }
  }

  function updateStepIndicator() {
    document.querySelectorAll(".step").forEach((step, index) => {
      step.classList.toggle("active", index + 1 <= currentStep);
    });
  }

  async function registrarAlumno(nombre, apellido, celular, email, password) {
    try {
      // Check if email already exists
      const { data: existingUser, error: checkError } = await supabase
        .from("alumnos")
        .select("email")
        .eq("email", email)
        .single();

      if (existingUser) {
        throw new Error("El correo electr√≥nico ya est√° en uso.");
      }

      const { data, error } = await supabase
        .from("alumnos")
        .insert([{ nombre, apellido, celular, email, password }])
        .select();
      if (error) throw error;
      return data[0];
    } catch (error) {
      console.error("Error registrando alumno:", error.message);
      throw error;
    }
  }

  async function registrarCompra(alumno_id, curso_id, monto) {
    try {
      const { data, error } = await supabase
        .from("compras")
        .insert([{ alumno_id, curso_id, monto, estado: "pendiente" }])
        .select();
      if (error) throw error;
      return data[0];
    } catch (error) {
      console.error("Error registrando compra:", error.message);
      throw error;
    }
  }

  async function actualizarCompraEstado(compraId, nuevoEstado) {
    try {
      const { data, error } = await supabase
        .from("compras")
        .update({ estado: nuevoEstado })
        .eq("id", compraId);
      if (error) throw error;
      return data[0];
    } catch (error) {
      console.error("Error actualizando estado de compra:", error.message);
      throw error;
    }
  }

  const mp = new MercadoPago('APP_USR-c879960d-a4ef-42cd-9ce1-2de5b532776f');

  async function createPreference(nombre, email, celular) {
    try {
      const response = await fetch("https://api.mercadopago.com/checkout/preferences", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer APP_USR-7768844323141640-020609-31205b38f84ff40c8f7a83b626df8b81-2082196144"
        },
        body: JSON.stringify({
          items: [{
            title: "Curso Profesional Avanzado de Liquidaci√≥n de Sueldos",
            quantity: 1,
            currency_id: "ARS",
            unit_price: 1
          }],
          payer: {
            name: nombre,
            email: email,
            phone: {
              number: celular
            }
          },
          back_urls: {
            success: window.location.href,
            failure: window.location.href,
            pending: window.location.href
          },
          auto_return: 'approved'
        })
      });
      const preference = await response.json();
      return preference.id;
    } catch (error) {
      console.error("Error creando preferencia de pago:", error);
      throw error;
    }
  }

  async function initializeCheckout(nombre, email, celular) {
    try {
      const preferenceId = await createPreference(nombre, email, celular);
      mp.bricks().create("wallet", "wallet_container", {
        initialization: { preferenceId },
        callbacks: {
          onReady: () => console.log("Brick listo"),
          onSubmit: () => console.log("Pago enviado"),
          onError: (error) => console.error("Error en el pago", error),
          onApprove: async (data) => {
            console.log("Pago aprobado:", data);
            // Actualizar estado de la compra a "pagado"
            await actualizarCompraEstado(compraId, "pagado");
            // Redirigir a la p√°gina principal con un par√°metro de √©xito
            window.location.href = "/?pago_exitoso=true";
          },
        },
      });
    } catch (error) {
      console.error("Error inicializando el checkout:", error);
    }
  }

  // Function to check for successful payment and redirect to login
  function checkPaymentSuccess() {
    const urlParams = new URLSearchParams(window.location.search);
    const pagoExitoso = urlParams.get('pago_exitoso');
    
    if (pagoExitoso === 'true') {
      // Remove the query parameter
      window.history.replaceState({}, document.title, "/");
      
      // Show success message
      alert("¬°Pago exitoso! Ser√°s redirigido al login.");
      
      // Redirect to login page after a short delay
      setTimeout(() => {
        window.location.href = "/login.html";
      }, 2000);
    }
  }

  // Call the function when the page loads
  checkPaymentSuccess();

  form.addEventListener("submit", async function(event) {
    event.preventDefault();
    
    submitBtn.disabled = true;
    btnText.innerHTML = '<div class="spinner"></div> Procesando...';
    
    try {
      const nombre = document.getElementById("nombre").value;
      const apellido = document.getElementById("apellido").value;
      const celular = document.getElementById("celular").value;
      const email = document.getElementById("email").value;
      const password = generarPassword();
      
      const alumno = await registrarAlumno(nombre, apellido, celular, email, password);
      const curso_id = 1;
      const monto = 4990;
      const compra = await registrarCompra(alumno.id, curso_id, monto);
      compraId = compra.id; // Almacenar el ID de la compra
      
      btnText.innerHTML = "‚úÖ Paso 2: Pagar";
      submitBtn.style.background = "#28a745";
      
      // Display the generated password
      alert(`Tu contrase√±a generada es: ${password}\nPor favor, gu√°rdala en un lugar seguro.`);
      
      setTimeout(() => {
        nextStep();
        if (currentStep === 2) initializeCheckout(nombre, email, celular);
      }, 1500);
    } catch (error) {
      console.error("Error en el registro:", error);
      submitBtn.disabled = false;
      btnText.innerHTML = "Continuar al Pago";
      
      // Display error message if email is already in use
      if (error.message === "El correo electr√≥nico ya est√° en uso.") {
        alert(error.message);
      }
    }
  });
  
  window.prevStep = prevStep;
  window.initializeCheckout = initializeCheckout;
});

  </script>
</body>
</html>
